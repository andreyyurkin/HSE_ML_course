# HSE_ML_course

## Что было сделано?

- Был проведен простейший EDA с обработкой признаков

- Признак `torque` был разделен на 2: `torque` и `max_torque_rpm` (Использовались регулярные вражения)

- Пропуски были обработаны (заполнены медианами)

- Для дополнительного исследования данных дальше шла визуализация

- После строилась самая простая модель только на вещественных признаках

- Далее используя GridSearchCV перебирали на сетке значения альфа для зануления некоторых предикторов (а таже пробавал в ElasticNet-регрессии, но лучше особо не получилось)

- Добавляем категориальные фичи в модель, перебираем гиперпараметры на сетке

- Логарифмируем стоимость автомобиля и строим пайплайн (лучший скор при логарифме, хотел еще другие фичи потрогать, но времени не хватает)

Например, можно было попробовать логарифмировать, возводить в степень год и пр.

- Написана бизнес-метрика, оценили модели с ее помощью

- создаем .pickle файл и закидываем туда пайплайн

- Далее в PyCharm с Помощью FastApi пишем микросервис для предсказания наших цен автомобиля, тестируем

### Ниже представлены скриншоты проверки на работу сервиса:

- Случай предсказания 1 объекта
<img width="1552" alt="Снимок экрана 2022-12-06 в 23 13 48" src="https://user-images.githubusercontent.com/98804878/206906865-dbf1e7d8-a06b-45ab-b6d4-d1680b32b267.png">

- Случай предсказания большого числа объектов (выводиться csv файл с дополнительным столбцом preds)
<img width="1552" alt="Снимок экрана 2022-12-06 в 23 15 10" src="https://user-images.githubusercontent.com/98804878/206906879-a126c302-0751-45d4-80e5-9993c3fb6f15.png">

## Наибольший буст?

Наибольший буст в качестве модели дало логарифмирование таргета (стоимости автомобиля)

## Итоговые результаты

- r2_score = 0.818

- business_metrics = 0.279

## Что не получилось?

Удивило, что категориальные фичи не добавилт ничего к скору, регуляризация тоже не то что бы спасала, возможно, после более сильного feature engineering
было бы получше, и уже на сильно обработанных данных эти методы добавляли бы к скору.

Надо было бы по идее еще пологарифмировать фичи, повозвадить их в степени, посмотреть на разные варианты, но у меня в решении логарифмируется только таргет
